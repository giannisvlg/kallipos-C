# 3. Εντολές ελέγχου και επανάληψης

<i>Σύνοψη</i> Η εντολή <span class="p-style">if</span>, ένθετες <span class="p-style">if</span>, η <span class="p-style">if‐else‐if</span>, ξεκρέμαστο <span class="p-style">if</span>, η εντολή <span class="p-style">switch</span>, οι εντολές επανάληψης <span class="p-style">for</span>, <span class="p-style">while</span> και <span class="p-style">do ... while</span>, ατέρμονοι βρόχοι, ένθετες επαναλήψεις, οι εντολές <span class="p-style">break</span>, <span class="p-style">continue</span> και <span class="p-style">goto</span>.  

<i>Προαπαιτούμενη γνώση</i> Τύποι δεδομένων, είσοδος/έξοδος.

## 3.1 Εισαγωγή

Η C ανήκει στις λεγόμενες προστακτικές (imperative) γλώσσες προγραμματισμού. Οι προστακτικές γλώσσες προγραμματισμού διαθέτουν εντολές ελέγχου ροής, δηλαδή εντολές επιλογής και εντολές επανάληψης, που επιτρέπουν στους προγραμματιστές να καθορίσουν βήμα προς βήμα τις εντολές που θα εκτελούνται. Ένα επιπλέον χαρακτηριστικό των προστακτικών γλωσσών είναι ότι οι μεταβλητές είναι τροποποιήσιμες (mutable), δηλαδή μπορούν να αλλάζουν τιμές κατά την εκτέλεση του προγράμματος. Με αυτόν τον τρόπο διατηρείται μια κατάσταση προγράμματος (program’s state) που αλλάζει καθώς εκτελούνται οι επιμέρους εντολές. Ο προγραμματιστής πρέπει να σχεδιάζει και να υλοποιεί το πρόγραμμα έτσι ώστε οι διαδοχικές αλλαγές στην κατάσταση του προγράμματος να παράγουν το επιθυμητό τελικό αποτέλεσμα. Υπάρχουν πολλές άλλες
γλώσσες που υποστηρίζουν το «προστακτικό παράδειγμα προγραμματισμού» (imperative programming paradigm) όπως η C++, η Java, η Python και η C#.

## 3.2 Εντολές επιλογής

Η C διαθέτει δύο εντολές επιλογής, την εντολή <span class="p-style">if</span> και την εντολή <span class="p-style">switch</span> που παρουσιάζονται στη συνέχεια.

### 3.2.1 Η εντολή if

Η εντολή <span class="p-style">if</span> έχει την ακόλουθη σύνταξη.

```
if (συνθήκη){
    // Μπλοκ κώδικα 1
} else{
    // Μπλοκ κώδικα 2
}
```

Αν η συνθήκη είναι αληθής, δηλαδή έχει μη μηδενική τιμή, τότε εκτελείται το μπλοκ κώδικα 1, ενώ αν είναι ψευδής, τότε εκτελείται το μπλοκ κώδικα 2. Συνεπώς, τα δύο μπλοκ κώδικα είναι μεταξύ τους αμοιβαία αποκλειόμενα. Το τμήμα <span class="p-style">else</span> μαζί με το μπλοκ κώδικα 2 είναι προαιρετικό. Αν ένα μπλοκ κώδικα περιέχει μόνο μια εντολή, τότε οι αγκύλες του μπλοκ μπορούν να παραλειφθούν, αν και θεωρείται καλή πρακτική να υπάρχουν αγκύλες ακόμα και για μπλοκ κώδικα με μια εντολή. Το ακόλουθο παράδειγμα (κώδικας 3.1) χρησιμοποιεί την <span class="p-style">if</span> με τη σύνταξη που δόθηκε και εξετάζει αν ένας αριθμός είναι άρτιος ή περιττός.

```{.c title="Κώδικας 3.1: ch3_p1.c - απλό παράδειγμα με την if." linenums="1"}
--8<-- "src/ch3_p1.c"
```
Ακολουθεί ένα παράδειγμα εκτέλεσης του κώδικα, όπου ο χρήστης εισάγει την τιμή 73.

```
Input an integer number: 73
The number 73 is odd.
```
Με βάση τις δυνατότητες που αναφέρθηκαν για τον τρόπο γραφής της <span class="p-style">if</span>, οι γραμμές του κώδικα 7-11 μπορούν να αντικατασταθούν, αφαιρώντας τις αγκύλες με τις ακόλουθες.

```
if (x%2==0)
    printf("The number %d is even.\n", x);
else
    printf("The number %d is odd.\n", x);
```
Επίσης, οι ίδιες γραμμές κώδικα (7-11) μπορούν να αντικατασταθούν με τις δύο διαδοχικές <span class="p-style">if</span> που ακολουθούν.

```
if (x%2==0)
    printf("The number %d is even.\n", x);
if (x%2==1)
    printf("The number %d is odd.\n", x);
```

Και στις δύο νέες περιπτώσεις οι κώδικες είναι ισοδύναμοι με τον αρχικό.

<i>Ένθετες if</i> Σε μια εντολή <span class="p-style">if</span>, στις εντολές που εκτελούνται αν η συνθήκη είναι αληθής ή στις εντολές που εκτελούνται αν η συνθήκη είναι ψευδής, μπορούν να υπάρχουν οποιεσδήποτε εντολές, άρα και νέες εντολές <span class="p-style">if</span>, οπότε δημιουργούνται οι λεγόμενες ένθετες ή εμφωλευμένες επιλογές (nested ifs). Ένα παράδειγμα ακολουθεί στη συνέχεια στον κώδικα 3.2 όπου εμφανίζεται για έναν αριθμό που δίνει ο χρήστης, το εάν είναι θετικός, αρνητικός ή μηδέν.

```{.c title="Κώδικας 3.2: ch3_p2.c - ένθετη επιλογή." linenums="1"}
--8<-- "src/ch3_p2.c"
```

<i>Η if-else-if </i> Συχνή είναι η χρήση της <span class="p-style">if</span> με τη μορφή <span class="p-style">if‐else‐if</span>. Πρόκειται, επί της ουσίας για μια μορφή ένθετων <span class="p-style">if</span>. Ο τρόπος γραφής της <span class="p-style">if‐else‐if</span> είναι ο ακόλουθος:

```
if (συνθήκη1)
    εντολή_1
else if (συνθήκη2)
    εντολή_2
else if (συνθήκη3)
    εντολή_3
...
else
    εντολή_ν
```
Στη μορφή αυτή της <span class="p-style">if</span>, οι συνθήκες αποτιμώνται στη σειρά από πάνω προς τα κάτω μέχρι να βρεθεί μια συνθήκη που να είναι αληθής. Τότε εκτελείται η εντολή ή το μπλοκ εντολών που αντιστοιχεί στην αληθή συνθήκη και η εκτέλεση συνεχίζει με την εντολή που ακολουθεί την εντολή <span class="p-style">if</span> συνολικά. Αν δεν βρεθεί καμία συνθήκη που να είναι αληθής, τότε εκτελούνται οι εντολές που βρίσκονται στο <span class="p-style">else</span> τμήμα της εντολής, εφόσον το τμήμα αυτό υπάρχει. Χρησιμοποιώντας την <span class="p-style">if-else-if</span>, ο κώδικας του προηγούμενου παραδείγματος γράφεται «καθαρότερα» όπως στη συνέχεια στον κώδικα 3.3.


```{.c title="Κώδικας 3.3: ch3_p2b.c - παράδειγμα με if-else-if." linenums="1"}
--8<-- "src/ch3_p2b.c"
```

Μια ιδιαιτερότητα της <span class="p-style">if</span> που θα πρέπει να γνωρίζει ο προγραμματιστής της C είναι το λεγόμενο «ξεκρέμαστο else» (dangling else) που αφορά τη συσχέτιση των <span class="p-style">else</span> με <span class="p-style">if</span> σε ένθετες επιλογές με πολλούς κλάδους <span class="p-style">if</span>. Αν υπάρχουν ένθετες <span class="p-style">if</span> και ένα <span class="p-style">else</span> όπως στο ακόλουθο παράδειγμα, τότε εκ πρώτης όψης δεν είναι φανερό σε ποιο από τα <span class="p-style">if</span> αντιστοιχεί το <span class="p-style">else</span>.

```
if (συνθήκη1)
    if (συνθήκη2)
        if (συνθήκη3)
            ...
else
    printf("ξεκρέμαστο else\n");
```
Μπορεί μάλιστα η μορφή γραφής του κώδικα να υποδεικνύει, όπως στο παράδειγμα, ότι το <span class="p-style">else</span> αντιστοιχεί στο πρώτο <span class="p-style">if</span>, κάτι που όμως δεν ισχύει. Ο κανόνας που επιλύει αυτό το πρόβλημα είναι ότι «η πρόταση <span class="p-style">else</span> ανήκει στο πλησιέστερο <span class="p-style">if</span> που δεν έχει κλείσει». Συνεπώς, στο παράδειγμα η <span class="p-style">else</span> κλείνει την <span class="p-style">if</span> με τη συνθήκη3. Ο δε κώδικας θα μπορούσε να στοιχιστεί όπως στη συνέχεια.

```
if (συνθήκη1)
    if (συνθήκη2)
        if (συνθήκη3)
            ...
        else
            printf("ξεκρέμαστο else\n");
```
<i>Εντολές if με σύνθετες συνθήκες </i> Μια σύνθετη συνθήκη δημιουργείται συνδυάζοντας με λογικούς τελεστές (<span class="p-style">&&</span> για λογικό ΚΑΙ, <span class="p-style">||</span> για λογικό Ή και <span class="p-style">!</span> για λογικό ΌΧΙ) απλές συνθήκες. Για παράδειγμα η σύνθετη συνθήκη  
(<span class="p-style">year % 4 == 0 && year % 100 != 0) || year % 400 == 0</span> συνδυάζει 3 απλές συνθήκες και γίνεται αληθής όταν η τιμή της ακέραιας μεταβλητής year διαιρείται με το 4 και δεν διαιρείται με το 100, εκτός και αν διαιρείται με το 400 οπότε πάλι γίνεται αληθής. Ο έλεγχος αυτός εξετάζει αν ένα έτος είναι δίσεκτο και στη συνέχεια παρουσιάζονται δύο λειτουργικά ισοδύναμοι κώδικες που ο πρώτος χρησιμοποιεί τη σύνθετη συνθήκη ενώ ο δεύτερος χρησιμοποιεί ένθετες <span class="p-style">if</span> και απλές συνθήκες.

```{.c title="Κώδικας 3.4: ch3_p3.c - έλεγχος για δίσεκτο έτος με σύνθετη συνθήκη." linenums="1"}
--8<-- "src/ch3_p3.c"
```

Ακολουθεί μια εκτέλεση του προγράμματος.

```
Input a year: 2023
2023 is not a leap year
```
Μια διαφορετική υλοποίηση για το ίδιο πρόβλημα παρουσιάζεται στη συνέχεια

```{.c title="Κώδικας 3.5: ch3_p3b.c - έλεγχος για δίσεκτο έτος με απλές συνθήκες και ένθετες if." linenums="1"}
--8<-- "src/ch3_p3b.c"
```
Ο δεύτερος κώδικας (κώδικας 3.5) είναι συνθετότερος από τον πρώτο (κώδικας 3.4). Ο απλούστερος και συντομότερος κώδικας είναι ο λόγος που συνήθως προτιμώνται οι σύνθετες συνθήκες έναντι των ένθετων <span class="p-style">if</span>. Ωστόσο, σε μερικές περιπτώσεις, ο κώδικας είναι περισσότερο κατανοητός αν χρησιμοποιηθεί συνδυασμός ένθετων <span class="p-style">if</span> και σύνθετων συνθηκών.


### 3.2.2 Η εντολή switch

Η <span class="p-style">switch</span> είναι η δεύτερη εντολή επιλογής της C και συνήθως χρησιμοποιείται λιγότερο συχνά από την <span class="p-style">if</span>. Η σύνταξή της είναι η ακόλουθη:

```
switch (έκφραση) {
    case σταθερά1:
        // Κώδικας που θα εκτελεστεί αν η έκφραση αποτιμηθεί στην τιμή σταθερά1
        break;
    case σταθερά2:
        // Κώδικας που θα εκτελεστεί αν η έκφραση αποτιμηθεί στην τιμή σταθερά2
        break;
    // Επιπλέον περιπτώσεις μπορούν να προστεθούν εδώ ανάλογα με τις ανάγκες
    default:
        // Κώδικας που θα εκτελεστεί αν η έκφραση δεν ταιριάξει με καμία από τις
            ↪ ανωτέρω σταθερές τιμές
        break;
}
```

Η τιμή της έκφρασης (που μπορεί να είναι μόνο ακέραια ή χαρακτήρας) συγκρίνεται από πάνω προς τα κάτω με τις τιμές των σταθερών σε κάθε περίπτωση <span class="p-style">case</span>. Αν υπάρξει ταύτιση τότε εκτελούνται οι αντίστοιχες εντολές. Αν δεν υπάρξει ταύτιση σε καμία από τις περιπτώσεις τότε εκτελείται το τμήμα default, εφόσον υπάρχει, καθώς είναι προαιρετικό. Παρατηρήστε ότι οι εντολές που ακολουθούν κάθε περίπτωση case δεν τοποθετούνται σε αγκύλες.  

Ακολουθεί ένα παράδειγμα χρήσης της <span class="p-style">switch</span>, στον κώδικα 3.6, στον οποίο ο χρήστης εισάγει έναν αριθμητικό τελεστή από τους <span class="p-style">+</span>, <span class="p-style">‐</span>, <span class="p-style">*</span>,<span class="p-style">/</span> καθώς και δύο τιμές και στη συνέχεια πραγματοποιείται η αριθμητική πράξη που επιλέχθηκε με τελεστέους τις δύο τιμές.


```{.c title="Κώδικας 3.6: ch3_p4.c - αριθμητικές πράξεις." linenums="1"}
--8<-- "src/ch3_p4.c"
```

Ένα παράδειγμα εκτέλεσης του κώδικα φαίνεται στη συνέχεια.

```
Enter an operator (+, ‐, *, /): /
Enter two numbers: 100 21
Result: 4.76
```
Παρατηρήστε ότι μετά από τον κώδικα κάθε περίπτωσης <span class="p-style">case</span> υπάρχει η εντολή <span class="p-style">break</span>, που προκαλεί έξοδο από τη <span class="p-style">switch</span>. Αν δεν τοποθετηθεί <span class="p-style">break</span> σε μια περίπτωση <span class="p-style">case</span> τότε ο έλεγχος συνεχίζει στην περίπτωση <span class="p-style">case</span> που ακολουθεί στη σειρά (follow-through). Αυτό το χαρακτηριστικό μπορεί να χρησιμοποιηθεί έτσι ώστε να προκύψει συντομότερος κώδικας όπως στο ακόλουθο παράδειγμα (κώδικας 3.7) που αναμένει τον χρήστη να εισαγάγει σε μια υποθετική ερώτηση είτε ’Y’ ή ’y’ είτε ’N’ ή ’n’.

```{.c title="Κώδικας 3.7: ch3_p5.c - περιπτώσεις case χωρίς break." linenums="1"}
--8<-- "src/ch3_p5.c"
```
Ακολουθεί ένα παράδειγμα εκτέλεσης του κώδικα.
```
Is C a great language? y
I agree!
```


## 3.3 Εντολές επανάληψης

Η C διαθέτει 3 εντολές επανάληψης, την <span class="p-style">for</span>, την <span class="p-style">while</span> και την <span class="p-style">do...while</span> που η λειτουργία τους μπορεί να τροποποιηθεί με τις εντολές <span class="p-style">continue</span> και <span class="p-style">break</span>. Επίσης, βρόχοι επανάληψης μπορούν να υλοποιηθούν και με την εντολή <span class="p-style">goto</span>, αν και αυτό δεν θεωρείται καλή πρακτική προγραμματισμού.

### 3.3.1 Η εντολή for

Η εντολή <span class="p-style">for</span> είναι η εντολή επανάληψης που χρησιμοποιείται συχνότερα. Έχει την ακόλουθη σύνταξη.

```
for (αρχικοποίηση; συνθήκη ελέγχου επανάληψης; ενημέρωση) {
    // Κώδικας που εκτελείται σε κάθε επανάληψη
}
```
Η δεσμευμένη λέξη <span class="p-style">for</span> ακολουθείται από 3 τμήματα που χωρίζονται μεταξύ τους με ερωτηματικά. Το πρώτο τμήμα (αρχικοποίηση) εκτελείται μια φορά στην αρχή της επανάληψης. Το δεύτερο τμήμα (συνθήκη ελέγχου επανάληψης) είναι μια συνθήκη που όσο είναι αληθής η εκτέλεση των εντολών επανάληψης συνεχίζεται. Όταν η συνθήκη γίνει ψευδής, το πρόγραμμα συνεχίζει την εκτέλεσή του με την εντολή που ακολουθεί το μπλοκ επανάληψης της <span class="p-style">for</span>. Το τρίτο τμήμα (ενημέρωση) εκτελείται στο τέλος κάθε επανάληψης και χρησιμοποιείται συνήθως για να ενημερώνει τη μεταβλητή (ή τις μεταβλητές) από την οποία εξαρτάται η συνέχεια ή ο τερματισμός της επανάληψης. Ένα απλό παράδειγμα χρήσης της <span class="p-style">for</span> είναι το ακόλουθο πρόγραμμα (κώδικας 3.8) που πραγματοποιεί 5 επαναλήψεις.

```{.c title="Κώδικας 3.8: ch3_p6.c - εκτέλεση του βρόχου επανάληψης 5 φορές" linenums="1"}
--8<-- "src/ch3_p6.c"
```
Αρχικά ανατίθεται στη μεταβλητή <span class="p-style">i</span> η τιμή 0. Μετά εξετάζεται η συνθήκη ελέγχου (<span class="p-style">i < 5</span>) για τη συνέχεια της επανάληψης. Λόγω του ότι είναι αληθής, εκτελείται το μπλοκ κώδικα που ακολουθεί που αποτελεί και το σώμα του βρόχου. Όταν ολοκληρωθεί η εκτέλεση του σώματος του βρόχου, η εκτέλεση συνεχίζεται με την αύξηση της μεταβλητής <span class="p-style">i</span> κατά 1 (με την εντολή <span class="p-style">i++</span>) και τον έλεγχο εκ νέου της συνθήκης της επανάληψης. Όταν το <span class="p-style">i</span> λάβει την τιμή 5, τότε η συνθήκη της επανάληψης θα γίνει ψευδής και θα τερματιστεί η επανάληψη. Συνεπώς, η έξοδος του προγράμματος θα είναι η ακόλουθη:

```
Loop 1, variable i = 0
Loop 2, variable i = 1
Loop 3, variable i = 2
Loop 4, variable i = 3
Loop 5, variable i = 4
```
Καθένα από τα 3 τμήματα μέσα στην παρένθεση αμέσως μετά τη δεσμευμένη λέξη <span class="p-style">for</span> μπορούν είτε να παραλειφθούν είτε να γίνουν συνθετότερα. Ακολουθεί ένα παράδειγμα (κώδικας 3.9) όπου η αρχικοποίηση και η ενημέρωση αποτελούνται η καθεμία από 2 επιμέρους εντολές που χωρίζονται μεταξύ τους με κόμμα (,) που αποτελεί ειδικό τελεστή για αυτήν την περίπτωση.

```{.c title="Κώδικας 3.9: ch3_p7.c - παράδειγμα με διπλή αρχικοποίηση στη for." linenums="1"}
--8<-- "src/ch3_p7.c"
```
Η εκτέλεση του προγράμματος θα εμφανίσει τα ακόλουθα αποτελέσματα.

```
i = 10, j = 30
i = 17, j = 32
i = 24, j = 34
i = 31, j = 36
```
Το επόμενο παράδειγμα (κώδικας 3.10) δείχνει τη χρήση της εντολής <span class="p-style">for</span> χωρίς να έχει τμήμα ενημέρωσης τιμών μεταβλητών επανάληψης, καθώς αυτό πραγματοποιείται στο συγκεκριμένο παράδειγμα μέσα στον βρόχο επανάληψης.

```{.c title="Κώδικας 3.10: ch3_p8.c - παράλειψη του τμήματος ενημέρωσης μεταβλητών επανάληψης της for" linenums="1"}
--8<-- "src/ch3_p8.c"
```

Ακολουθεί η έξοδος του προγράμματος.

```
Loop 1, variable i = 1
Loop 2, variable i = 2
Loop 3, variable i = 3
Loop 4, variable i = 4
Loop 5, variable i = 5
```

### 3.3.2 Η εντολή while

Μια άλλη εντολή επανάληψης της C είναι η εντολή <span class="p-style">while</span> που επαναλαμβάνει ένα μπλοκ εντολών όσο μια συνθήκη είναι αληθής. Η σύνταξή της είναι η ακόλουθη.

```
while (συνθήκη) {
    // Κώδικας που εκτελείται σε κάθε επανάληψη
}
```

Η συνθήκη ελέγχεται στην αρχή κάθε επανάληψης και αν είναι αληθής εκτελείται το μπλοκ εντολών που ακολουθεί. Αν το μπλοκ εντολών περιέχει μία μόνο εντολή, τότε οι αγκύλες του μπλοκ μπορούν να παραλειφθούν. Αν η συνθήκη είναι ψευδής, τότε τερματίζεται ο βρόχος επανάληψης και το πρόγραμμα συνεχίζει την εκτέλεσή του με την εντολή αμέσως μετά το μπλοκ εντολών. Καθώς ο έλεγχος της συνθήκης για τη συνέχεια ή τον τερματισμό της επανάληψης βρίσκεται πριν το μπλοκ εντολών, υπάρχει περίπτωση η συνθήκη να είναι αρχικά ψευδής και να μην γίνει καμία επανάληψη. Στη συνέχεια, στον κώδικα 3.11 παρουσιάζεται ένα παράδειγμα χρήσης της εντολής <span class="p-style">while</span> που υπολογίζει το μικρότερο πλήθος διαδοχικών ακεραίων που ξεκινούν από το 1 και που το άθροισμά τους ξεπερνά την τιμή 1000.

```{.c title="Κώδικας 3.11: ch3_p9.c - παράδειγμα επανάληψης με τη while." linenums="1"}
--8<-- "src/ch3_p9.c"
```
Ακολουθεί το αποτέλεσμα της εκτέλεσης του κώδικα.

```
The smallest number n such that 1+2+...+n > 1000 is: 45
```

Σε κάθε επανάληψη ελέγχεται η τιμή του <span class="p-style">sum</span>, που έχει αρχικοποιηθεί στο μηδέν, και αν είναι μικρότερη ή ίση του 1000 εκτελείται ο βρόχος επανάληψης. Σε κάθε επανάληψη η τιμή του <span class="p-style">sum</span> ενημερώνεται προσθέτοντας στο <span class="p-style">sum</span> την τρέχουσα τιμή του <span class="p-style">n</span>, και στη συνέχεια αυξάνεται η τιμή του <span class="p-style">n</span> κατά 1. Όταν η συνθήκη της επανάληψης γίνει ψευδής, τότε ο βρόχος τερματίζεται. Παρατηρήστε ότι η τιμή που εμφανίζεται για το <span class="p-style">n</span> στη γραμμή 10, είναι μειωμένη κατά 1, διότι η μεταβλητή n αυξάνεται στον βρόχο μετά την εντολή που προσθέτει την τρέχουσα τιμή του <span class="p-style">n</span> στο <span class="p-style">sum</span>, οπότε όταν γίνεται ο έλεγχος στη συνθήκη της επανάληψης (για το εάν sum < 1000), η τελευταία τιμή που έχει προστεθεί στο <span class="p-style">sum</span> είναι η μικρότερη κατά ένα τιμή του <span class="p-style">n</span>, σε σχέση με την τρέχουσα τιμή της. Από την άλλη μεριά, αν παραλειφθεί η εντολή <span class="p-style">sum += n</span> τότε η τιμή του <span class="p-style">sum</span> δεν θα αλλάζει κάθε φορά που θα εκτελείται ο βρόχος και η επανάληψη θα συνεχίζεται επ’ άπειρο. Ο τερματισμός εκτέλεσης του προγράμματος σε αυτήν την περίπτωση γίνεται με τον συνδυασμό πλήκτρων Ctrl + C και είναι ευθύνη του προγραμματιστή να γράφει κώδικα με τέτοιον τρόπο ώστε να μη συμβαίνουν άπειροι ή όπως αλλιώς ονομάζονται ατέρμονοι βρόχοι (infinite loop).
### 3.3.3 Η εντολή do...while

Παρόμοια με την εντολή <span class="p-style">while</span> είναι και η εντολή <span class="p-style">do...while</span>, με τη διαφορά ότι ο έλεγχος συνέχειας ή τερματισμού της επανάληψης γίνεται μετά το μπλοκ εντολών και όχι πριν όπως στη <span class="p-style">while</span>. Η σύνταξη <span class="p-style">της do...while</span> είναι η ακόλουθη:
```
do {
    // Κώδικας που εκτελείται σε κάθε επανάληψη
} while (συνθήκη);
```

Οι εντολές του βρόχου επανάληψης εκτελούνται αρχικά και στη συνέχεια εξετάζεται η συνθήκη της επανάληψης. Αν η συνθήκη είναι αληθής τότε οι εντολές του βρόχου εκτελούνται ξανά. Αν όμως η συνθήκη είναι ψευδής, τότε η επανάληψη σταματά και το πρόγραμμα συνεχίζει την εκτέλεσή του με την εντολή που ακολουθεί τη <span class="p-style">while</span>. H <span class="p-style"> do..while</span> είναι χρήσιμη σε καταστάσεις που επιθυμούμε να διασφαλίσουμε ότι ο βρόχος επανάληψης θα εκτελεστεί τουλάχιστον μια φορά, ανεξάρτητα από τη συνθήκη της επανάληψης. Στο ακόλουθο παράδειγμα (κώδικας 3.12) το πρόγραμμα εμφανίζει ένα μενού με 3 επιλογές και προτρέπει τον χρήστη να εισάγει την επιλογή του έτσι ώστε να εκτυπωθεί ένα μήνυμα ή να τερματίσει η επανάληψη. Η επιλογή της <span class="p-style">do...while</span> φαίνεται να είναι καταλληλότερη, διότι επιθυμούμε το μενού να εμφανιστεί τουλάχιστον μία φορά, ανεξάρτητα από την τιμή της μεταβλητής <span class="p-style">choice</span>.

```{.c title="Κώδικας 3.12: ch3_p10.c - παράδειγμα επανάληψης με τη do...while." linenums="1"}
--8<-- "src/ch3_p10.c"
```
Ακολουθεί ένα παράδειγμα εκτέλεσης του κώδικα.

```
Select an option:
1. Print 'Hello'
2. Print 'Goodbye '
3. Quit
Enter your choice: 4
Invalid choice. Please try again.
Select an option:
1. Print 'Hello'
2. Print 'Goodbye '
3. Quit
Enter your choice: 1
Hello
Select an option:
1. Print 'Hello'
2. Print 'Goodbye '
3. Quit
Enter your choice: 3
Quitting the program...
```

### 3.3.4 Οι εντολές break και continue

Οι εντολές <span class="p-style">break</span> και <span class="p-style">continue</span> μπορούν να χρησιμοποιηθούν στις εντολές επανάληψης για να παρακάμψουν τον προκαθορισμένο τρόπο λειτουργίας τους. Η εντολή <span class="p-style">break</span> προκαλεί πρόωρο τερματισμό της επανάληψης, ενώ η εντολή <span class="p-style">continue</span> προκαλεί μετάβαση στον έλεγχο της συνθήκης της επανάληψης, όπου και καθορίζεται αν η επανάληψη θα συνεχιστεί ή θα τερματιστεί.   

<i>Παραδείγματα με την εντολή break </i> Στο πρώτο παράδειγμα με τη <span class="p-style">break</span>, στον κώδικα 3.13, ο χρήστης εισάγει 5 ακέραιες τιμές και το πρόγραμμα υπολογίζει και εμφανίζει το άθροισμα των τιμών που εισήχθησαν. Αν όμως ο χρήστης εισάγει την τιμή -1, τότε η επανάληψη τερματίζει και εμφανίζεται το άθροισμα από τις τιμές που έχουν εισαχθεί μέχρι εκείνο το σημείο.

```{.c title="Κώδικας 3.13: ch3_p11.c - παράδειγμα με την εντολή break." linenums="1"}
--8<-- "src/ch3_p11.c"
```
Ακολουθεί ένα παράδειγμα εκτέλεσης.

```
Enter a value: 7
Enter a value: 11
Enter a value: ‐1
The sum is 18
```
Η εντολή <span class="p-style">break</span> μπορεί να χρησιμοποιηθεί με ατέρμονους βρόχους επανάληψης όπως αυτοί που ακολουθούν, δίνοντας τη δυνατότητα να τερματιστεί η επανάληψη.

```
for(;;){                    | while (1){               |  do {
    // βρόχος επανάληψης    |   // βρόχος επανάληψης   |   // βρόχος επανάληψης
}                           | }                        |  } while (1);

```

Στο δεύτερο παράδειγμα με τη <span class="p-style">break</span>, στον κώδικα 3.14, ο χρήστης εισάγει τιμές μέχρι να εισαχθεί η τιμή -1. Ο κώδικας χρησιμοποιεί την εντολή <span class="p-style">break</span> για να «βγει» από τον ατέρμονα βρόχο.


```{.c title="Κώδικας 3.14: ch3_p12.c - παράδειγμα με «ατέρμονα βρόχο» και την break." linenums="1"}
--8<-- "src/ch3_p12.c"
```

Ακολουθεί ένα παράδειγμα εκτέλεσης.

```
Enter a number (‐1 to exit): 42
You entered: 42
Enter a number (‐1 to exit): 73
You entered: 73
Enter a number (‐1 to exit): ‐1
Loop terminated.
```

<i>Παράδειγμα με την εντολή continue </i> Στο παράδειγμα του κώδικα 3.15 εκτελούνται 10 επαναλήψεις με την εντολή <span class="p-style">for</span>, με τη μεταβλητή επανάληψης <span class="p-style">i</span> να λαμβάνει τιμές από 0 μέχρι και 9. Σε κάθε επανάληψη εμφανίζεται η τιμή της μεταβλητής επανάληψης, εκτός από τις περιττές τιμές δείκτη που είναι μεγαλύτερες του 5. Η παράλειψη εκτύπωσης της τιμής της μεταβλητής επανάληψης επιτυγχάνεται τοποθετώντας την εντολή <span class="p-style">continue</span> στην κατάλληλη θέση.

```{.c title="Κώδικας 3.15: ch3_p13.c - παράδειγμα με την continue." linenums="1"}
--8<-- "src/ch3_p13.c"
```

Το αποτέλεσμα της εκτέλεσης είναι: 0 1 2 3 4 5 6 8.

### 3.3.5 Ένθετοι βρόχοι

Ένας ένθετος βρόχος είναι ένας βρόχος που περικλείεται σε έναν άλλο βρόχο. Ακολουθεί ένα απλό παράδειγμα ένθετων βρόχων με την εντολή <span class="p-style">for</span> (κώδικας 3.16). Ο εξωτερικός βρόχος εκτελείται 5 φορές και για κάθε επανάληψή του ο ένθετος βρόχος εκτελείται 2 φορές. Άρα συνολικά η εντολή <span class="p-style">printf</span> θα εκτελεστεί 10 φορές.

```{.c title="Κώδικας 3.16: ch3_p14.c - ένθετοι βρόχοι." linenums="1"}
--8<-- "src/ch3_p14.c"
```
Συνεπώς, η εκτέλεση του κώδικα θα δώσει τα ακόλουθα αποτελέσματα:

```
i=0, j=0
i=0, j=1
i=1, j=0
i=1, j=1
i=2, j=0
i=2, j=1
i=3, j=0
i=3, j=1
i=4, j=0
i=4, j=1
```

Οι ένθετοι βρόχοι μπορεί να είναι συνθετότεροι. Στο επόμενο παράδειγμα (κώδικας 3.17), το πλήθος των
επαναλήψεων του ένθετου βρόχου αλλάζει από επανάληψη σε επανάληψη.

```{.c title="Κώδικας 3.17: ch3_p15.c - ένθετοι βρόχοι." linenums="1"}
--8<-- "src/ch3_p15.c"
```

Ακολουθεί το αποτέλεσμα της εκτέλεσης.

```
1
2 1
3 2 1
4 3 2 1
5 4 3 2 1
```

### 3.3.6 Η εντολή goto

Η <span class="p-style">goto</span> είναι μια εντολή αλλαγής της ροής του προγράμματος που προκαλεί μετάβαση σε ένα σημείο του προγράμματος που προσδιορίζεται από μια ετικέτα. Η μετάβαση γίνεται χωρίς να εξαρτάται από κάποια συνθήκη και συνεπώς πραγματοποιείται απευθείας αλλαγή της ροής εκτέλεσης του προγράμματος. Ακολουθεί ένα παράδειγμα χρήσης της <span class="p-style">goto</span>, στον κώδικα 3.18, που δημιουργεί έναν βρόχο επανάληψης που τερματίζεται όταν ο χρήστης εισάγει την τιμή -1. Το όνομα της ετικέτας στο παράδειγμα αυτό είναι <span class="p-style">loop</span>.

```{.c title="Κώδικας 3.18: ch3_p16.c - παράδειγμα με τη goto." linenums="1"}
--8<-- "src/ch3_p16.c"
```

Ο κώδικας είναι λειτουργικά ισοδύναμος με το παράδειγμα με την εντολή break του κώδικα 3.14 και συνεπώς παράγει τα ίδια αποτελέσματα.  

Γενικά, προτείνεται η αποφυγή της εντολής <span class="p-style">goto</span> διότι ο κώδικας που προκύπτει είναι πιθανό να είναι δυσκολότερο να αναγνωσθεί και να κατανοηθεί [^1]. Ο κώδικας με πολλά <span class="p-style">goto</span> συχνά αναφέρεται και ως spaghetti κώδικας και όπως παραστατικά περιγράφεται στο [^2] σε συνδυασμό με άλλους παράγοντες μπορεί να οδηγήσει σταδιακά στη μεταμόρφωση του λογισμικού σε “big ball of mud” (μεγάλη σφαίρα λάσπης), με μηδενικές δυνατότητες επέκτασης και διόρθωσης. Ωστόσο, σε ορισμένες περιπτώσεις [^3] η <span class="p-style">goto</span> μπορεί να χρησιμοποιηθεί αποδοτικά έτσι ώστε να απλοποιήσει τον έλεγχο ροής εκτέλεσης του προγράμματος ή να χειριστεί σφάλματα. Ακολουθούν δύο παραδείγματα που η <span class="p-style">goto</span> δίνει εύκολο στην κατανόηση κώδικα. Στο πρώτο παράδειγμα (κώδικας 3.19) η <span class="p-style">goto</span> προκαλεί την έξοδο από μια τριπλά ένθετη επανάληψη με <span class="p-style">for</span>, ενώ στο δεύτερο παράδειγμα (κώδικας 3.21) απομονώνει τον χειρισμό εισαγωγής τιμών που οδηγούν σε σφάλματα.

```{.c title="Κώδικας 3.19: ch3_p17.c - έξοδος από ένθετες επαναλήψεις με την goto." linenums="1"}
--8<-- "src/ch3_p17.c"
```
Η εκτέλεση του προγράμματος θα εμφανίσει τα ακόλουθα αποτελέσματα, καθώς όταν οι μεταβλητές <span class="p-style">i</span>, <span class="p-style">j</span> και <span class="p-style">k</span> λάβουν τιμές που θα προκαλέσουν την εκτέλεση της <span class="p-style">goto</span> θα γίνει απευθείας έξοδος και από τις 3 επαναλήψεις.

```
i=0, j=0, k=0
i=0, j=0, k=1
i=0, j=0, k=2
i=0, j=0, k=3
i=0, j=0, k=4
i=0, j=1, k=0
i=0, j=1, k=1
i=0, j=1, k=2
Exit from the nested loops!
```
Ο κώδικας 3.20 δείχνει πώς θα μπορούσε να επιτευχθεί το ίδιο αποτέλεσμα, χωρίς <span class="p-style">goto</span>, αλλά συνθετότερα και λιγότερο αποδοτικά.

```{.c title="Κώδικας 3.20: ch3_p17b.c - έξοδος από ένθετες επαναλήψεις." linenums="1"}
--8<-- "src/ch3_p17b.c"
```

Στο επόμενο παράδειγμα (κώδικας 3.21) παρουσιάζεται ένας συνηθισμένος τρόπος χειρισμού λαθών με την <span class="p-style">goto</span>. Στο παράδειγμα ζητείται η είσοδος δύο ακεραίων τιμών από τον χρήστη και ο υπολογισμός του πηλίκου του πρώτου με τον δεύτερο, καθώς και ο υπολογισμός της τετραγωνικής ρίζας του πρώτου αριθμού. Τα σημεία του κώδικα που προκαλούν σφάλματα (διαίρεση με το μηδέν, τετραγωνική ρίζα με αρνητικό υπόριζο) κατευθύνουν τη ροή εκτέλεσης του προγράμματος με την <span class="p-style">goto</span> σε συγκεκριμένο τμήμα του κώδικα (γραμμές 17-19) που εμφανίζει μήνυμα σφάλματος και τερματίζει την εκτέλεση του προγράμματος.


```{.c title="Κώδικας 3.21: ch3_p18.c - χειρισμός λαθών με την goto." linenums="1"}
--8<-- "src/ch3_p18.c"
```

Ακολουθεί παράδειγμα εκτέλεσης.
```
Enter two numbers: ‐1 2
Error: because math!
```

Συμπερασματικά, η υπερβολική χρήση της <span class="p-style">goto</span> ή η χρήση της <span class="p-style">goto</span> στη θέση άλλων δομών που θα έδιναν απλούστερο κώδικα, μπορεί να οδηγήσει σε φτωχά δομημένο κώδικα που είναι δύσκολο να συντηρηθεί. Η γενική σύσταση είναι να προτιμώνται οι δομές επιλογής και επανάληψης όπως οι <span class="p-style">if</span>, <span class="p-style">switch</span>, <span class="p-style">for</span> και <span class="p-style">while</span>, όπου αυτό είναι δυνατό.

##  3.4 Ασκήσεις

***Άσκηση 1***
Γράψτε ένα πρόγραμμα που να ελέγχεται από ένα μενού επιλογών με τις επιλογές 1) ημίτονο, 2) συνημίτονο, 3) εφαπτομένη. Ανάλογα με την επιλογή του χρήστη να εμφανίζει τις τιμές της τριγωνομετρικής συνάρτησης που επιλέγεται για όλες τις τιμές γωνιών από 1 μέχρι και 360 μοίρες. Χρησιμοποιήστε τις συναρτήσεις <span class="p-style">sin()</span> (ημίτονο), <span class="p-style">cos()</span> (συνημίτονο) και <span class="p-style">tan()</span> (εφαπτομένη) από την τυπική βιβλιοθήκη της C που ορίζονται στο <span class="p-style">math.h</span>. Προσέξτε ότι οι συναρτήσεις αυτές λειτουργούν με τιμές σε ακτίνια, οπότε πρέπει πρώτα οι μοίρες να μετατραπούν σε ακτίνια. Η μετατροπή μιας γωνίας από μοίρες σε ακτίνια γίνεται πολλαπλασιάζοντας τις μοίρες με το (𝜋/180).

??? note "Λύση άσκησης 1"
    ```{.c linenums="1"}
    --8<-- "src/ch3_e1.c"
    ```

***Άσκηση 2***
Γράψτε ένα πρόγραμμα που να ελέγχει αν δύο αριθμοί που εισάγει ο χρήστης είναι φίλιοι αριθμοί. Δύο αριθμοί λέγεται ότι είναι φίλιοι αν το άθροισμα των διαιρετών του καθένα από τους δύο αριθμούς (εξαιρώντας τον ίδιο τον αριθμό) είναι ίσο με τον άλλο αριθμό. Για παράδειγμα οι αριθμοί 220 και 284 είναι φίλιοι αριθμοί καθώς  

284 = 1 + 2 + 4 + 5 + 10 + 11 + 20 + 22 + 44 + 55 + 110 (οι διαιρέτες του 220)  

και  

220 = 1 + 2 + 4 + 71 + 142 (οι διαιρέτες του 284).


??? note "Λύση άσκησης 2"
    ```{.c linenums="1"}
    --8<-- "src/ch3_e2.c"
    ```

***Άσκηση 3***
Με βάση τη λύση που δώσατε στην προηγούμενη άσκηση, υπολογίστε το πλήθος των ζυγών φίλιων αριθμών στο διάστημα από 1 μέχρι 10000.

??? note "Λύση άσκησης 3"
    ```{.c linenums="1"}
    --8<-- "src/ch3_e3.c"
    ```

***Άσκηση 4***
Η φόρμουλα του Wallis(1), από το 1652,
{ .annotate }

1. <a href="https://en.wikipedia.org/wiki/Wallis_product" target="_blank">https://en.wikipedia.org/wiki/Wallis_product</a>

$$
\frac{\pi}{2} = \left(\frac{2}{1} \times \frac{2}{3}\right) \times \left(\frac{4}{3} \times \frac{4}{5}\right) \times \left(\frac{6}{5} \times \frac{6}{7}\right) \times \left(\frac{8}{7} \times \frac{8}{9}\right) \times \dots
$$
μπορεί να χρησιμοποιηθεί για τον υπολογισμό μία προσέγγιση του 𝜋. Γράψτε ένα πρόγραμμα που χρησιμοποιώντας τη φόρμουλα να υπολογίζει την προσέγγιση του 𝜋. Ο υπολογισμός να συνεχίζεται για ένα πλήθος όρων του γινομένου που θα δίνεται από τον χρήστη.

??? note "Λύση άσκησης 4"
    ```{.c linenums="1"}
    --8<-- "src/ch3_e4.c"
    ```

[^1]: Edsger W Dijkstra. “Letters to the editor: go to statement considered harmful”. Στο: Communications of the ACM 11.3 (1968), σσ. 147–148.

[^2]: Brian Foote και Joseph Yoder. “Big ball of mud”. Στο: Pattern languages of program design 4 (1997), σσ. 654–692.

[^3]: Delroy A. Brinkerhoff. Object Oriented Proggramming using C++. Supplemental: Legitimate Uses For goto. <a href="https://icarus.cs.weber.edu/~dab/cs1410/textbook/3.Control/goto.html" target="_blank">https://icarus.cs.weber.edu/~dab/cs1410/textbook/3.Control/goto.html</a>. Accessed: 2023-06-01.